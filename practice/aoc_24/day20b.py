from ipython_startup.imports import *

# fmt: off

inp_o = """\
#############################################################################################################################################
#...#.......#.....#.......#.....###.......#...###...............###...#...#...#...........#.........###...#.......#.....#.....#.....#...#...#
#.#.#.#####.#.###.#.#####.#.###.###.#####.#.#.###.#############.###.#.#.#.#.#.#.#########.#.#######.###.#.#.#####.#.###.#.###.#.###.#.#.#.#.#
#.#.#.....#...#...#...#...#...#...#.....#...#...#.............#...#.#.#.#...#.#...#.......#...#.....#...#...#.....#...#.#.#...#...#.#.#.#.#.#
#.#.#####.#####.#####.#.#####.###.#####.#######.#############.###.#.#.#.#####.###.#.#########.#.#####.#######.#######.#.#.#.#####.#.#.#.#.#.#
#.#.#...#.....#...#...#.....#.#...#...#...#.....#...#...#.....#...#.#.#...#...#...#.....#.....#.....#.......#.#...###.#...#...#...#.#.#...#.#
#.#.#.#.#####.###.#.#######.#.#.###.#.###.#.#####.#.#.#.#.#####.###.#.###.#.###.#######.#.#########.#######.#.#.#.###.#######.#.###.#.#####.#
#.#.#.#.#...#...#.#...#.....#.#...#.#.#...#...#...#...#.#...#...#...#...#.#...#...#.....#.........#.#...#...#.#.#...#.#.......#...#.#.#...#.#
#.#.#.#.#.#.###.#.###.#.#####.###.#.#.#.#####.#.#######.###.#.###.#####.#.###.###.#.#############.#.#.#.#.###.#.###.#.#.#########.#.#.#.#.#.#
#.#...#.#.#.#...#.....#...###.#...#.#.#.#.....#.....#...#...#.....#.....#...#.#...#.#...###.....#.#...#.#...#.#.#...#.#...#...#...#.#.#.#...#
#.#####.#.#.#.###########.###.#.###.#.#.#.#########.#.###.#########.#######.#.#.###.#.#.###.###.#.#####.###.#.#.#.###.###.#.#.#.###.#.#.#####
#.....#.#.#.#...........#...#.#.....#.#.#...#...#...#.#...#.....#...###...#.#.#...#...#...#...#.#...#...#...#.#.#...#.#...#.#.#.#...#.#.....#
#####.#.#.#.###########.###.#.#######.#.###.#.#.#.###.#.###.###.#.#####.#.#.#.###.#######.###.#.###.#.###.###.#.###.#.#.###.#.#.#.###.#####.#
#.....#...#...###...#...#...#...#.....#...#.#.#.#...#...#...###...#...#.#.#.#.#...#.......#...#.#...#...#.#...#...#...#...#.#.#.#.....#...#.#
#.###########.###.#.#.###.#####.#.#######.#.#.#.###.#####.#########.#.#.#.#.#.#.###.#######.###.#.#####.#.#.#####.#######.#.#.#.#######.#.#.#
#.......#...#...#.#.#...#.......#.#...#...#.#.#...#...#...###...#...#...#.#.#.#...#.#.....#...#.#.....#.#.#.###...#.......#.#.#.#.......#...#
#######.#.#.###.#.#.###.#########.#.#.#.###.#.###.###.#.#####.#.#.#######.#.#.###.#.#.###.###.#.#####.#.#.#.###.###.#######.#.#.#.###########
#.....#...#...#.#.#...#.........#...#...#...#.#...###.#.....#.#.#...#...#...#...#.#.#.#...#...#...#...#...#...#...#.#.......#...#.#...#...###
#.###.#######.#.#.###.#########.#########.###.#.#####.#####.#.#.###.#.#.#######.#.#.#.#.###.#####.#.#########.###.#.#.###########.#.#.#.#.###
#.#...#.....#.#.#...#.#...###...#...#...#.#...#.......#.....#.#...#...#.#.....#.#.#.#.#.....#.....#.....#...#.###.#.#.#...........#.#.#.#...#
#.#.###.###.#.#.###.#.#.#.###.###.#.#.#.#.#.###########.#####.###.#####.#.###.#.#.#.#.#######.#########.#.#.#.###.#.#.#.###########.#.#.###.#
#.#...#...#.#.#.....#...#...#...#.#...#...#.#.........#...###.#...#...#...#...#...#.#.......#.###.....#.#.#...#...#...#.....###.....#...#...#
#.###.###.#.#.#############.###.#.#########.#.#######.###.###.#.###.#.#####.#######.#######.#.###.###.#.#.#####.###########.###.#########.###
#.#...#...#...#...........#.#...#...###...#...###...#.#...#...#...#.#.......#.......###.....#...#...#.#.#...#...#...........#...#...#.....###
#.#.###.#######.#########.#.#.#####.###.#.#######.#.#.#.###.#####.#.#########.#########.#######.###.#.#.###.#.###.###########.###.#.#.#######
#.#...#...#...#.#.........#...#...#...#.#.###...#.#.#.#.#...#.....#.........#.#...#...#...#.....#...#.#.#...#...#.#.....###...#...#...###...#
#.###.###.#.#.#.#.#############.#.###.#.#.###.#.#.#.#.#.#.###.#############.#.#.#.#.#.###.#.#####.###.#.#.#####.#.#.###.###.###.#########.#.#
#...#.###.#.#...#...#...#.....#.#...#...#.#...#.#.#...#.#.#...#...#...#.....#.#.#.#.#.###.#...###...#...#.......#...#...#...#...###.....#.#.#
###.#.###.#.#######.#.#.#.###.#.###.#####.#.###.#.#####.#.#.###.#.#.#.#.#####.#.#.#.#.###.###.#####.#################.###.###.#####.###.#.#.#
#...#...#...#.....#...#...#...#.#...#.....#.#...#...#...#.#.###.#.#.#.#.....#.#.#.#.#...#.#...#...#.#.....#.....#.....#...#...#...#.#...#.#.#
#.#####.#####.###.#########.###.#.###.#####.#.#####.#.###.#.###.#.#.#.#####.#.#.#.#.###.#.#.###.#.#.#.###.#.###.#.#####.###.###.#.#.#.###.#.#
#.#...#.....#...#.......###.....#...#...#...#...#...#...#.#...#.#.#.#.#.....#.#.#...#...#.#...#.#.#.#...#...###...#.....#...#...#...#.....#.#
#.#.#.#####.###.#######.###########.###.#.#####.#.#####.#.###.#.#.#.#.#.#####.#.#####.###.###.#.#.#.###.###########.#####.###.#############.#
#.#.#...#...###.....#...#.....#...#...#.#...#...#...#...#.#...#.#.#.#.#...#...#...#...###...#.#.#.#...#.#.....#...#.#.....###.#.............#
#.#.###.#.#########.#.###.###.#.#.###.#.###.#.#####.#.###.#.###.#.#.#.###.#.#####.#.#######.#.#.#.###.#.#.###.#.#.#.#.#######.#.#############
#.#...#.#...#...#...#.###...#.#.#.#...#...#.#...#...#...#.#...#.#.#.#.....#.#...#.#.#...#...#.#.#.#...#...#...#.#.#.#.###.....#.......###...#
#.###.#.###.#.#.#.###.#####.#.#.#.#.#####.#.###.#.#####.#.###.#.#.#.#######.#.#.#.#.#.#.#.###.#.#.#.#######.###.#.#.#.###.###########.###.#.#
#.....#...#...#...#...#...#.#.#.#...#...#.#.#...#...#...#...#...#.#.....###.#.#...#...#.#.#...#.#.#.#...#...###.#.#.#.....#...........#...#.#
#########.#########.###.#.#.#.#.#####.#.#.#.#.#####.#.#####.#####.#####.###.#.#########.#.#.###.#.#.#.#.#.#####.#.#.#######.###########.###.#
#.........#...#...#.....#...#...#.....#.#...#.....#.#.#...#.#.....#...#.#...#.#.......#...#...#.#...#.#...#...#.#.#.#.......###.........#...#
#.#########.#.#.#.###############.#####.#########.#.#.#.#.#.#.#####.#.#.#.###.#.#####.#######.#.#####.#####.#.#.#.#.#.#########.#########.###
#.........#.#.#.#...#...#...#...#.#.....#...###...#.#.#.#.#.#.#...#.#.#.#...#...#...#...#.....#.###...#...#.#...#...#.#...#...#.#.......#...#
#########.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.###.###.#.#.#.#.#.#.#.#.#.#.###.#####.#.###.#.#####.###.###.#.#.#########.#.#.#.#.#.#.#####.###.#
#.........#.#...###.#.#.#.#.#.#...#.......#.#...#...#.#.#...#.#.#...#.#.###...#...#.#...#.#...#...#...#.#...#.......#...#...#...#.....#.#...#
#.#########.#######.#.#.#.#.#.#############.#.###.###.#.#####.#.#####.#.#####.#.###.#.###.#.#.###.###.#.#####.#####.#################.#.#.###
#...#.....#.#.....#.#.#...#...#.........#...#.#...#...#.....#.#...#...#...###.#...#.#...#.#.#...#...#...#...#.....#...........#...#...#.#...#
###.#.###.#.#.###.#.#.#########.#######.#.###.#.###.#######.#.###.#.#####.###.###.#.###.#.#.###.###.#####.#.#####.###########.#.#.#.###.###.#
#...#.###.#.#...#...#.....#...#.......#.#...#...###.....#...#.#...#.....#.#...#...#.....#.#...#...#.#.....#.......#.......#...#.#...###...#.#
#.###.###.#.###.#########.#.#.#######.#.###.###########.#.###.#.#######.#.#.###.#########.###.###.#.#.#############.#####.#.###.#########.#.#
#...#.#...#...#.....#.....#.#.#...#...#.....#.......#...#...#.#.....###.#.#...#.......###.#...###.#.#.#.............#.....#.....#.......#...#
###.#.#.#####.#####.#.#####.#.#.#.#.#########.#####.#.#####.#.#####.###.#.###.#######.###.#.#####.#.#.#.#############.###########.#####.#####
#...#.#.#.....###...#.#.....#...#.#...#.......#...#.#.......#...#...#...#.#...#.....#...#...#...#.#.#...#...#.........###.....#...#.....#...#
#.###.#.#.#######.###.#.#########.###.#.#######.#.#.###########.#.###.###.#.###.###.###.#####.#.#.#.#####.#.#.###########.###.#.###.#####.#.#
#.....#...#.......#...#.........#.....#.......#.#...#.........#...###.#...#...#...#.#...#####.#...#.#.....#...#.....#...#.#...#.#...#.....#.#
###########.#######.###########.#############.#.#####.#######.#######.#.#####.###.#.#.#######.#####.#.#########.###.#.#.#.#.###.#.###.#####.#
#...###...#.......#.#...........#.......###...#...#...#.....#...#...#...#...#...#.#...#######.......#...........#...#.#.#.#.....#.....#.....#
#.#.###.#.#######.#.#.###########.#####.###.#####.#.###.###.###.#.#.#####.#.###.#.###############################.###.#.#.#############.#####
#.#...#.#.#.......#.#.......#...#.#.....#...#...#...#...###...#...#.....#.#.....#.###############################.....#...#...........#.....#
#.###.#.#.#.#######.#######.#.#.#.#.#####.###.#.#####.#######.#########.#.#######.#########################################.#########.#####.#
#...#.#.#.#.....#...#.....#...#...#.......#...#.......###...#...#.....#.#...#...#.#####################...#...#####E#.....#.........#.......#
###.#.#.#.#####.#.###.###.#################.#############.#.###.#.###.#.###.#.#.#.#####################.#.#.#.#####.#.###.#########.#########
#...#.#.#...###...###...#.#...............#.........#...#.#.###...#...#.#...#.#.#...#################...#...#.....#.#...#.#...#.....###...###
#.###.#.###.###########.#.#.#############.#########.#.#.#.#.#######.###.#.###.#.###.#################.###########.#.###.#.#.#.#.#######.#.###
#...#.#.#...#...#...#...#.#.#.......#...#...#.....#...#...#.......#...#.#...#.#...#.#......S#########...#.....#...#.#...#...#...###...#.#...#
###.#.#.#.###.#.#.#.#.###.#.#.#####.#.#.###.#.###.###############.###.#.###.#.###.#.#.#################.#.###.#.###.#.#############.#.#.###.#
#...#...#...#.#.#.#.#.#...#...#...#...#...#.#...#.#...#...#...#...###.#.###...###...#...#...#...#...#...#...#...###...#.......#...#.#.#.#...#
#.#########.#.#.#.#.#.#.#######.#.#######.#.###.#.#.#.#.#.#.#.#.#####.#.###############.#.#.#.#.#.#.#.#####.###########.#####.#.#.#.#.#.#.###
#...#.....#...#...#...#.....#...#.......#.#...#.#.#.#.#.#.#.#.#.....#...#.....#...#...#...#...#.#.#.#.#.....#...#...###.....#.#.#.#.#...#.###
###.#.###.#################.#.#########.#.###.#.#.#.#.#.#.#.#.#####.#####.###.#.#.#.#.#########.#.#.#.#.#####.#.#.#.#######.#.#.#.#.#####.###
###...###.#.............#...#.........#.#...#...#...#...#...#.......#...#...#.#.#.#.#.......###...#...#.....#.#.#.#.#...#...#...#...#...#...#
#########.#.###########.#.###########.#.###.#########################.#.###.#.#.#.#.#######.###############.#.#.#.#.#.#.#.###########.#.###.#
#.........#.#...........#...#.....#...#...#.........#...........#.....#.#...#.#.#.#.....#...#.....#.........#.#.#.#.#.#.#.#.....#...#.#.....#
#.#########.#.#############.#.###.#.#####.#########.#.#########.#.#####.#.###.#.#.#####.#.###.###.#.#########.#.#.#.#.#.#.#.###.#.#.#.#######
#.#...#...#.#...........#...#...#...#...#...........#.#.........#.....#.#...#.#.#...###.#...#...#.#...........#...#...#...#...#.#.#.#.......#
#.#.#.#.#.#.###########.#.#####.#####.#.#############.#.#############.#.###.#.#.###.###.###.###.#.###########################.#.#.#.#######.#
#...#...#...###...#.....#.....#.......#.....#...#...#.#.....#.....#...#...#.#.#.#...#...#...#...#...#...#.....#...#...#.......#.#.#.#.....#.#
###############.#.#.#########.#############.#.#.#.#.#.#####.#.###.#.#####.#.#.#.#.###.###.###.#####.#.#.#.###.#.#.#.#.#.#######.#.#.#.###.#.#
#...............#.#.....#...#.#...#.........#.#...#.#.#.....#...#...#...#...#...#...#.#...###.....#...#...###...#...#.#.......#.#.#.#...#.#.#
#.###############.#####.#.#.#.#.#.#.#########.#####.#.#.#######.#####.#.###########.#.#.#########.###################.#######.#.#.#.###.#.#.#
#.#.............#.....#...#.#...#...#.....###.#.....#.#.......#.......#...#...#...#.#.#.#...#...#.....#...........#...#...#...#...#.#...#...#
#.#.###########.#####.#####.#########.###.###.#.#####.#######.###########.#.#.#.#.#.#.#.#.#.#.#.#####.#.#########.#.###.#.#.#######.#.#######
#...#...........#...#.......#.........#...#...#.......#.......#...#.....#...#...#.#.#.#.#.#.#.#.#...#...#...#.....#.....#...###...#...###...#
#####.###########.#.#########.#########.###.###########.#######.#.#.###.#########.#.#.#.#.#.#.#.#.#.#####.#.#.#################.#.#######.#.#
#...#.............#.........#.#.......#.....#...#...#...#.....#.#.#.#...#...#...#.#...#...#...#...#.......#.#...#.........#...#.#.#...#...#.#
#.#.#######################.#.#.#####.#######.#.#.#.#.###.###.#.#.#.#.###.#.#.#.#.#########################.###.#.#######.#.#.#.#.#.#.#.###.#
#.#...................#...#...#.....#.........#...#...###.#...#.#.#.#.###.#.#.#.#...#...#...#...#.........#.....#.#.....#...#...#...#.#...#.#
#.###################.#.#.#########.#####################.#.###.#.#.#.###.#.#.#.###.#.#.#.#.#.#.#.#######.#######.#.###.#############.###.#.#
#.#.................#.#.#.#.......#...............#.....#.#.#...#.#.#.#...#...#...#...#.#.#...#...#.....#.........#...#.............#.....#.#
#.#.###############.#.#.#.#.#####.###############.#.###.#.#.#.###.#.#.#.#########.#####.#.#########.###.#############.#############.#######.#
#...#.....#...#.....#...#.#.....#.#.......#.......#.#...#.#.#.#...#.#.#.....#.....#...#...#.......#...#.....#...#...#...........###...#...#.#
#####.###.#.#.#.#########.#####.#.#.#####.#.#######.#.###.#.#.#.###.#.#####.#.#####.#.#####.#####.###.#####.#.#.#.#.###########.#####.#.#.#.#
#...#...#...#...#...#...#...#...#...#...#...#...###.#.###.#.#.#...#.#.#...#.#.#...#.#.....#.....#.###.....#.#.#...#.#...#.......#...#...#.#.#
#.#.###.#########.#.#.#.###.#.#######.#.#####.#.###.#.###.#.#.###.#.#.#.#.#.#.#.#.#.#####.#####.#.#######.#.#.#####.#.#.#.#######.#.#####.#.#
#.#.....#.......#.#...#...#...#.......#.#.....#...#.#.#...#...#...#.#.#.#.#.#...#.#.#.....###...#.........#.#.....#.#.#.#.........#.....#.#.#
#.#######.#####.#.#######.#####.#######.#.#######.#.#.#.#######.###.#.#.#.#.#####.#.#.#######.#############.#####.#.#.#.###############.#.#.#
#.......#...#...#.###...#.#...#.#.......#.....#...#.#.#...#...#.#...#...#...#.....#.#...#...#.....#...#...#.......#.#.#.........#.....#.#...#
#######.###.#.###.###.#.#.#.#.#.#.###########.#.###.#.###.#.#.#.#.###########.#####.###.#.#.#####.#.#.#.#.#########.#.#########.#.###.#.#####
#.......#...#.....#...#...#.#.#.#.....#...#...#.#...#.###.#.#...#.........#...#...#.#...#.#.....#...#...#.#.......#.#.........#.#...#.#.....#
#.#######.#########.#######.#.#.#####.#.#.#.###.#.###.###.#.#############.#.###.#.#.#.###.#####.#########.#.#####.#.#########.#.###.#.#####.#
#...#.....#...#.....#.....#.#...###...#.#.#...#.#.#...#...#.###...###.....#...#.#...#.###.....#.#.......#...#.....#.#.........#.....#.....#.#
###.#.#####.#.#.#####.###.#.#######.###.#.###.#.#.#.###.###.###.#.###.#######.#.#####.#######.#.#.#####.#####.#####.#.###################.#.#
#...#.#.....#...#...#...#...###...#...#.#.#...#.#.#.###...#...#.#...#.#...#...#.#.....#.....#.#.#.....#.......#...#...#...#...#...#.....#.#.#
#.###.#.#########.#.###.#######.#.###.#.#.#.###.#.#.#####.###.#.###.#.#.#.#.###.#.#####.###.#.#.#####.#########.#.#####.#.#.#.#.#.#.###.#.#.#
#.....#.........#.#.#...#...#...#.....#.#.#...#.#.#.#...#.#...#.#...#...#.#.###.#.#...#...#.#.#.#...#...........#.......#...#...#...#...#.#.#
###############.#.#.#.###.#.#.#########.#.###.#.#.#.#.#.#.#.###.#.#######.#.###.#.#.#.###.#.#.#.#.#.#################################.###.#.#
#.....#.........#.#...#...#...#...#...#.#.#...#.#.#.#.#.#.#...#.#.#...#...#.#...#.#.#...#.#.#.#.#.#...#...#.........#.....#...#...#...###...#
#.###.#.#########.#####.#######.#.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.###.#.###.#.#.#.#.#.###.#.#.#.#######.#.###.#.#.#.#.#.#########
#.#...#.....#.....#...#...#.....#.#.#.#.#.#...#.#.#...#.#.#...#.#.#.#.#.###...###.#...#.#.#.#.#.#...#...#.#.......#...###...#...#...###.....#
#.#.#######.#.#####.#.###.#.#####.#.#.#.#.###.#.#.#####.#.#.###.#.#.#.#.#########.###.#.#.#.#.#.###.#####.#######.#####################.###.#
#.#.........#.#.....#.#...#.#.....#.#...#...#.#.#.....#.#.#.#...#...#.#.........#.#...#.#.#...#.#...#...#.......#.......#...#.........#...#.#
#.###########.#.#####.#.###.#.#####.#######.#.#.#####.#.#.#.#.#######.#########.#.#.###.#.#####.#.###.#.#######.#######.#.#.#.#######.###.#.#
#.#...........#.....#...#...#...#...#.....#...#.#.....#...#...#.......#.....#...#.#.#...#.###...#.....#.....###.......#.#.#.#.#.......###.#.#
#.#.###############.#####.#####.#.###.###.#####.#.#############.#######.###.#.###.#.#.###.###.#############.#########.#.#.#.#.#.#########.#.#
#.#.#...............#...#.....#.#...#...#.......#.............#.......#...#.#...#.#.#...#...#...#.....#...#.......###.#...#...#.###...#...#.#
#.#.#.###############.#.#####.#.###.###.#####################.#######.###.#.###.#.#.###.###.###.#.###.#.#.#######.###.#########.###.#.#.###.#
#...#...#...........#.#...#...#.#...###.........#.............#.......#...#.....#...#...#...#...#.###.#.#.#.....#...#.#...#...#.....#...#...#
#######.#.#########.#.###.#.###.#.#############.#.#############.#######.#############.###.###.###.###.#.#.#.###.###.#.#.#.#.#.###########.###
#...###...#.........#...#...#...#...#...#.......#.............#...#...#.............#...#.###...#...#.#.#.#...#.#...#.#.#...#...#...#.....###
#.#.#######.###########.#####.#####.#.#.#.###################.###.#.#.#############.###.#.#####.###.#.#.#.###.#.#.###.#.#######.#.#.#.#######
#.#.#...#...#.....#...#.#.....#.....#.#...#...#.....#.....#...#...#.#...#...........#...#...#...#...#...#.#...#.#.###.#...#.....#.#.#.....###
#.#.#.#.#.###.###.#.#.#.#.#####.#####.#####.#.#.###.#.###.#.###.###.###.#.###########.#####.#.###.#######.#.###.#.###.###.#.#####.#.#####.###
#.#...#.#.#...###...#.#.#...#...#.....#...#.#.#.#...#...#.#.###...#.#...#.#.....###...#.....#...#.#####...#...#.#...#...#.#.#...#.#.#...#...#
#.#####.#.#.#########.#.###.#.###.#####.#.#.#.#.#.#####.#.#.#####.#.#.###.#.###.###.###.#######.#.#####.#####.#.###.###.#.#.#.#.#.#.#.#.###.#
#.....#...#...#...#...#.#...#.###.......#...#.#.#...#...#.#.#.....#.#...#.#.#...#...#...#.......#...#...#...#.#...#.###.#.#...#.#.#.#.#...#.#
#####.#######.#.#.#.###.#.###.###############.#.###.#.###.#.#.#####.###.#.#.#.###.###.###.#########.#.###.#.#.###.#.###.#.#####.#.#.#.###.#.#
#.....#...#...#.#...#...#...#.#.........#...#.#...#.#...#...#.......###.#...#...#...#...#.#.....#...#.#...#...#...#...#.#.....#.#.#.#...#...#
#.#####.#.#.###.#####.#####.#.#.#######.#.#.#.###.#.###.###############.#######.###.###.#.#.###.#.###.#.#######.#####.#.#####.#.#.#.###.#####
#.#.....#.#...#.....#.#...#...#.......#...#...#...#.....#...#...........#...#...###.#...#...#...#...#...###.....#...#.#...#...#...#...#.....#
#.#.#####.###.#####.#.#.#.###########.#########.#########.#.#.###########.#.#.#####.#.#######.#####.#######.#####.#.#.###.#.#########.#####.#
#.#...###...#.#.....#.#.#.............#...#...#.........#.#.#.......#.....#.#.....#.#.#.......#...#...#...#.#...#.#...###...###...#...#...#.#
#.###.#####.#.#.#####.#.###############.#.#.#.#########.#.#.#######.#.#####.#####.#.#.#.#######.#.###.#.#.#.#.#.#.#############.#.#.###.#.#.#
#...#...#...#.#.....#.#...#...#...#.....#.#.#.#.......#.#.#.........#.###...#...#.#.#.#.#...#...#...#...#.#...#.#...............#.#.#...#...#
###.###.#.###.#####.#.###.#.#.#.#.#.#####.#.#.#.#####.#.#.###########.###.###.#.#.#.#.#.#.#.#.#####.#####.#####.#################.#.#.#######
###...#.#.....#.....#.###...#...#.#.#.....#.#.#.....#...#.#.....#...#...#.....#.#.#...#.#.#.#.....#.#...#...#...#...........#.....#...#.....#
#####.#.#######.#####.###########.#.#.#####.#.#####.#####.#.###.#.#.###.#######.#.#####.#.#.#####.#.#.#.###.#.###.#########.#.#########.###.#
#...#.#.#.......#...#.#...........#.#.....#.#.#...#.....#...###.#.#...#.......#.#.....#...#...#...#.#.#.#...#...#.........#...#...#...#.#...#
#.#.#.#.#.#######.#.#.#.###########.#####.#.#.#.#.#####.#######.#.###.#######.#.#####.#######.#.###.#.#.#.#####.#########.#####.#.#.#.#.#.###
#.#...#.#.#.....#.#.#.#...#...#...#.#.....#.#.#.#.#...#.#.......#...#...#...#.#.#...#.#.......#...#.#.#.#.#.....#...#...#.......#...#...#...#
#.#####.#.#.###.#.#.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#########.###.#.#.#.#.#.#.#.#.#########.#.#.#.#.#.#####.#.#.#.###################.#
#.......#...###...#...###...#...#...#.......#...#...#...#...........###...#...#...#...#...........#...#...#.......#...#.....................#
#############################################################################################################################################"""

inp_s = """\
###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############"""

# fmt: on

sam = 0
sam = 0x0000000000000001
inp = inp_s if sam else inp_o

g = list(map(list, inp.splitlines()))
h, w = len(g), len(g[0])

for y in range(h):
    for x in range(w):
        if g[y][x] == "S":
            sy, sx = y, x
        elif g[y][x] == "E":
            ey, ex = y, x

DIRS = ((0, 1), (1, 0), (0, -1), (-1, 0))

q = deque([(int(0), ey, ex)])
b = {q[0][1:]: 0}
while q:
    d, y, x = q.popleft()
    for ay, ax in DIRS:
        ay += y
        ax += x
        if 0 <= ay < h and 0 <= ax < w and g[y][x] != "#":
            if (ay, ax) not in b:
                b[ay, ax] = d + 1
                q.append((d + 1, ay, ax))


q = deque([(int(0), sy, sx)])
b2 = {q[0][1:]: 0}
ans = 0
while q:
    d, y, x = q.popleft()
    for dy in range(-20, 21):
        for dx in range(-20, 21):
            if abs(dy) + abs(dx) <= 20 and 0 <= y + dy < h and 0 <= x + dx < w:
                ay = y + dy
                ax = x + dx
                if g[ay][ax] != "#":
                    D = (abs(dy) + abs(dx)) + b[ay, ax]
                    save = b[y, x] - D
                    # if save > 20:
                    #     print(y, x, dy, dx, save, "X", d, b[y, x], b[ay + dy, ax + dx])
                    if sam and save == 50:
                        ans += 1
                    elif save >= 100:
                        ans += 1
                if g[ay][ax] not in ("#", "E") and (ay, ax) not in b2:
                    b2[ay, ax] = d + 1
                    q.append((d + 1, ay, ax))

print(ans)
