from ipython_startup.imports import *

# fmt: off

inp_o = """\
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^...^.^...................................................................
.............................................................................................................................................
..................................................................^...^.^.^..................................................................
.............................................................................................................................................
.................................................................^...^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.^.^.....^.^................................................................
.............................................................................................................................................
...............................................................^...^.....^...^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^...^.^.^.^..............................................................
.............................................................................................................................................
.............................................................^.....^...^.....^.^.............................................................
.............................................................................................................................................
............................................................^...^.^.^.^.......^.^............................................................
.............................................................................................................................................
...........................................................^.^.^.^...^.^.^.^...^.^...........................................................
.............................................................................................................................................
..........................................................^.....^.^.^.^.....^.^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^...^.^.^.^...^...^.........................................................
.............................................................................................................................................
........................................................^.^...^.^.^.^.....^.^.^.....^........................................................
.............................................................................................................................................
.......................................................^...^...^...^.^.^.....^.....^.^.......................................................
.............................................................................................................................................
......................................................^.^.^...^.^.^.^.^.^.^.^...^.^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^.......^.^.^.^.^.^.^...^.^.....................................................
.............................................................................................................................................
....................................................^...^.^.^.^...^...^.^.....^.^.^.^.^.^....................................................
.............................................................................................................................................
...................................................^.^.^.^...^.^...^.^.^.^...^...^.^.^.^.^...................................................
.............................................................................................................................................
..................................................^.^.^.^.....^.^...^.^...^.^...^.^...^...^..................................................
.............................................................................................................................................
.................................................^...^.^.^.....^.^.^.....^.^.^...^.^.^.^.^.^.................................................
.............................................................................................................................................
................................................^.^.........^.^.^.^.^.^.^.......^.^...^.^.^.^................................................
.............................................................................................................................................
...............................................^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^...^...^.^..............................................
.............................................................................................................................................
.............................................^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.......^...^.............................................
.............................................................................................................................................
............................................^...^.^.^.^...^.^.^.^.^.^.^.^.....^.^.^.^.^...^.^...^............................................
.............................................................................................................................................
...........................................^.^.^...^.^.^.^...^.^.^.^...^.^.^.^.^.^...^.^.^...^.^.^...........................................
.............................................................................................................................................
..........................................^...^...^.^...^.^.^...^.^.^.^...^...^.^...^.^...^.^.^...^..........................................
.............................................................................................................................................
.........................................^.^...^...^.^...^.^...^.^.....^.^.^...^.^...^.^.^.^.^.....^.........................................
.............................................................................................................................................
........................................^.^.^...^.^.^.....^...^.^...^.^...^.^.^.^...........^.^.^.^.^........................................
.............................................................................................................................................
.......................................^.^.^.^...^...^...^.^.^.^...^.^.^.^.^.....^.^...^.^.^.........^.......................................
.............................................................................................................................................
......................................^.^.^.^.^...^.....^.^.^...^.......^.^...^.....^.^...^.^.^.^...^.^......................................
.............................................................................................................................................
.....................................^...^.^.^.^.^...^...^.^.....^...^...^...^.^.......^.^.^...^...^.^.^.....................................
.............................................................................................................................................
....................................^.^...^.^...^.^.....^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.^...^...^.^....................................
.............................................................................................................................................
...................................^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^...^...^.^...^.^...^...................................
.............................................................................................................................................
..................................^...^.^.^.^.^...^.^.^.........^.^.^...^.^.^.^.^.^.....^.^...^.^...^.....^..................................
.............................................................................................................................................
.................................^.^...^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^...^.^.^.^...^.....^...^.................................
.............................................................................................................................................
................................^.^.^.^.^.^.....^.^.^.^.^.....^.^...^...^...^...^.^.^...^.^.....^.^...^.....^................................
.............................................................................................................................................
...............................^...^...^.^...^.^.^.^.^...^.^.......^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.....^...^...............................
.............................................................................................................................................
..............................^...^.......^.^.^...^.^...^.^...^.^.^.^.^.^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.....^..............................
.............................................................................................................................................
.............................^.......^.^.^...^.^.^.^.^.^.^.^.........^.^...^.^.^.^.....^.....^...^.^.^...^.^.^.^.............................
.............................................................................................................................................
............................^.^.^.^.......^.....^.^.^.^...^.^...^.....^.....^...^...^.^.^.^...^.^.^...^.^.^.^.^.^............................
.............................................................................................................................................
...........................^...^.^.^.^.......^.^.^...^...^.^.^.^.^.^...^.....^.....^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.^.^.^.....^...^.^.^.^.^.....^.......^.....^.^.^.^.^...^.^.^.^.^.^.^.^.^.....^.^.^.^..........................
.............................................................................................................................................
.........................^.^...^...^.^...^.....^...^...^...^.^.^.....^.^.^...^...^.^.^.....^.^.^.^.^.^.^.^.^...^.^.^.........................
.............................................................................................................................................
........................^.^.^.^.^.^.^.^...^...........^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^.^.^........................
.............................................................................................................................................
.......................^...^.^...^...^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^...^.^...^.^.^...^...^.^.....^.^...^.^.......................
.............................................................................................................................................
......................^.^...^.....^.^...^...^.^.....^.^.^...^...^...^.^.^.^.^.^...^...^.^.^.......^...^.^.^.^...^.^.^.^......................
.............................................................................................................................................
.....................^.^...^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.....^.^.^.^...^.^...^.^.^...^.^...^.^.^...^.^.^.....................
.............................................................................................................................................
....................^.^.^...^.^...^.^.^.^.^.^.^.^...^.^...^.^.^.^...^.^.^...^.......^.^.....^.^.^...^.^.^...^.^.^.^.^.^.^....................
.............................................................................................................................................
...................^.^.....^.^.^.^.^.^.^.^.^...^.^.^...^...^.....^.^.^...^.....^.^.^...^.^...^.^.^.^...^.......^...^.^.^.^...................
.............................................................................................................................................
..................^.^.....^...^.^...^.^.^.^...^.^.^...^.^.^...^...^.^.....^...^.^.^.^.^.^...^.^.^.^...^.^.........^...^.^.^..................
.............................................................................................................................................
.................^...^.^.^.^.^.....^...^.^.^.^...^.^.^...^.^.^.^.^.^.......^.^.^.^.....^.........^...^.^...^.^.^.^.....^.^.^.................
.............................................................................................................................................
................^.^...^...^.^.^...^...^...^.^.^.^.^...^.....^.^.^...^.^.^.^...^.^.^.....^.^.^.^.....^...^.^.^.^.^...^.^.^.^.^................
.............................................................................................................................................
...............^.^.^...^...^.^.^.^...^.^.^.....^...^.^.^.^.^.^.^.^.^.^.........^...^.....^.^.^.^.^.^...^.^.^.^.^.......^.^...^...............
.............................................................................................................................................
..............^...^.^.^.^.^.^.^.^.^...^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^...^.^...^.^.....^.....^.....^...^.^..............
.............................................................................................................................................
.............^...^.....^.^.^...^.^...^...^.^.^.^...^...^.^.^.^...^...^.^.^.^...^...^.^.^...^...^...^...^.^...^...^.....^...^.^.^.............
.............................................................................................................................................
............^...^...^.^.^.^...^.^.^...^.^.....^...^.^...^.^.^.....^.....^.^.......^...^.^.^.^...^.^.^...^.^...^.^.^...^.^.^...^.^............
.............................................................................................................................................
...........^.^...^.....^.....^.^.^.....^.....^.^.^.^.^.........^.^.^.....^.^.^...^...^.^.^.^.^...^.^...^.^.^.^.....^...^.^.^...^.^...........
.............................................................................................................................................
..........^.^.^.^.^.^.^...^.^.^...^...^...^...^.^.^.^.^.^.^.^...^...^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^...^.^.^.^.....^.^.^...^.^.^..........
.............................................................................................................................................
.........^.....^...^.^.^...^.^...^.^...^...^...^.^.^...^.^.^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.....^.^...^.^.^.^.^...^.^.........
.............................................................................................................................................
........^.^.^.^.^...^.^...^.^.^...^...^.^.^...^.....^.^.....^.^.^.^.^.^.^.^.^.^...^...^.....^.^.^.^.^.^.^.....^.^.^.^...^.^...^.^.^.^........
.............................................................................................................................................
.......^...^...^.^.^.....^.^.......^.^.^.^.^.^.......^.^...^.^.^.^.^.^.^.^.^.^.......^.^...^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^.^.^.......
.............................................................................................................................................
......^...^.^.^.^.^...^.^...^...^.........^...^.^.^.^.^.^...^...^.^.^.^.....^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^......
.............................................................................................................................................
.....^.^.^...^.^.^...^.^...^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^...^.^.^.^.^.^.^...........^.^...^.^...^.^.^.^...^...^.^.^.^.^.....
.............................................................................................................................................
....^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^...^...^.....^.....^...^.^.^.^.....^.^.^.^.......^.^...^...^.^.^.^...^.^.^.^.^...^.^.^...^.^....
.............................................................................................................................................
...^.^.....^.^.^...^.^.^.....^.^.^.....^.^.^.....^...^.^.......^.^.^.^.....^.^.....^...^...^...^.^...^.^.^.^.^...^.^.^.^.^...^...^...^.^.^...
.............................................................................................................................................
..^.....^.^.^.^.^.^.^.^...^...^.^.....^.^.....^.......^.^.^.....^...^...^.^.^.^...^.....^.^.^.^.^.^.^.^.^.......^.^.^.....^...^.^.^...^.^.^..
.............................................................................................................................................
.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.....^.^...^...^.^...^...^.....^...^.^.......^.^.....^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^...^.^.^.
............................................................................................................................................."""

inp_s = """\
.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
..............."""

# inp_s = """\
# .......S.......
# ...............
# .......^.......
# ...............
# ......^.^......
# ..............."""

# fmt: on

sam = 0
sam = 0x000000000000000
inp = inp_s if sam else inp_o

g = inp.splitlines()
h, w = len(g), len(g[0])
for y in range(h):
    for x in range(w):
        if g[y][x] == "S":
            sy, sx = y, x


b = set()


@cache
def f(y, x):
    if y >= h or x < 0 or x >= w:
        return 0
    if g[y][x] == "^":
        b.add((y, x))
        return f(y, x - 1) + f(y, x + 1) + 1
    return f(y + 1, x)


print(f(sy, sx))
print(len(b))
